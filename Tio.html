<!DOCTYPE html>
<html id="HTML*">

    <head lang="en">

        <!-- NOME DO PROJETO -->
        <title>Tio</title>
        <!-- [NOME DO PROJETO] -->

        <!-- <link rel="stylesheet" href="Styles.css"> -->
        <link rel="manifest" href="Tio/ArquvosJs/manifest.json">

        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="viewport" content="minimum-scale=1"/>    
        <meta name="viewport" content="height=device-height, 
        width=device-width, initial-scale=1.0, 
        minimum-scale=1.0, maximum-scale=1.0, 
        user-scalable=no, target-densitydpi=device-dpi">

        <style>
            /* width */
            ::-webkit-scrollbar {
            width: 5px; height: 5px; 
            }

            /* Track */
            ::-webkit-scrollbar-track {
            background: #d9d9d9; 
            }

            /* Handle */
            ::-webkit-scrollbar-thumb {
            background: #898989; 
            }

            /* Handle on hover */
            ::-webkit-scrollbar-thumb:hover {
            background: #000000; 
            }

            :root {
                --xPos: 300px;
                --bg-color: rgb(28, 0, 128);
                --txt-color: white;
                --ImFi:"C:/Users/Paulo/Documents/CHAKUR/TÉCNICOS/Programação/JAVA SCRIPT/Curso JS/PyCss/Image/canvas-630-654.jpg";
            }


            header {
                position: sticky;
                top: 0;
            }


            html {
                            margin:0;
                            padding:0;
                            /*line-height: 1.5em;*/
                            height: 100px;
                            width: 100px;
                            background-color: rgb(26, 150, 76);
                            }

            body {
                            /*position: fixed;*/
                            margin:0;
                            padding:0;
                            /*line-height: 1.5em;*/
                            height: 100%;
                            width: 100%;
                            background-color: rgb(126, 250, 176);
                            }



            /*  ----------- FORMATAÇÃO REMOTA  ---------------------------------  */
            /*  FORMAT OBJS  */
            #Fundo{position: fixed; left: 0.0px; top: 0.0px; width: 1200.0px; height: 850.0px; box-sizing: content-box; margin: 0px; padding: 0.0px; cursor: crosshair; -webkit-box-reflect: 0px  linear-gradient(0deg, rgba(0,0,0,)); border-color: black; border-radius: 0.0px; border-width: 0.0px; border-style: groove; background-color: rgb(215, 235, 211); color: light gray;  }
                #checkIncl{position: absolute; left: 252.0px; top: 10.0px; width: 24.0px; height: 23.0px; box-sizing: content-box; margin: 0px; padding: 0px; border-color: black; border-width: 0px; border-style: solid; outline-style: solid; outline-width: 2.0px; outline-offset: 1.0px; outline-color: rgb(255, 128, 64); color: rgb(64, 0, 128);  }
                #alteCapa{position: absolute; left: 305.0px; top: 393.0px; width: 103.0px; height: 222.0px; box-sizing: content-box; margin: 0px; padding: 0px; -webkit-box-reflect: 0px  linear-gradient(0deg, rgba(0,0,0,)); overflow: hidden; border-color: rgb(35, 72, 220); border-width: 1.0px; border-style: solid; background-color: rgb(215, 235, 211);  }
                    #peqAlte{position: absolute; left: 14px; top: 19px; width: 100px; height: 50px; box-sizing: content-box; margin: 0px; padding: 0px; border-color: black; border-width: 0px; border-style: solid; background-color: rgb(255, 255, 0);  }
                #divBranca{position: absolute; left: 561.0px; top: 4.0px; width: 632.0px; height: 606.0px; box-sizing: content-box; margin: 0px; padding: 0px; overflow: scroll; border-color: black; border-width: 0px; border-style: solid; background-color: rgb(255, 255, 255);  }
#divBranca::-webkit-scrollbar { width: 1.0px; height: 1.0px }  
                    #divGeral{position: absolute; left: 15.0px; top: 10.0px; width: 119.0px; height: 188.0px; box-sizing: content-box; margin: 0px; padding: 0px; -webkit-box-reflect: 0px  linear-gradient(0deg, rgba(0,0,0,)); overflow: hidden; border-color: black; border-width: 0px; border-style: solid; outline-style: solid; outline-width: 0.0px; outline-offset: 3.0px; outline-color: rgb(128, 0, 255); background-color: rgb(236, 245, 253);  }
                        #divPaiNum{position: absolute; left: 12.0px; top: 170.0px; width: 91.0px; height: 18.0px; box-sizing: content-box; margin: 0px; padding: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; -webkit-box-reflect: 0px  linear-gradient(0deg, rgba(0,0,0,)); scroll-padding: 0px; scroll-padding-block: 0px; scroll-padding-inline: 0px; border-color: black; border-width: 0px; border-style: solid; background-color: rgb(236, 245, 253); font-family: 'Times New Roman', serif; font-size: 15.0px;  }
                        #divPaiCapa{position: absolute; left: 4.0px; top: 3.0px; width: 110px; height: 166px; right: 5.0px; box-sizing: content-box; margin: 0px; padding: 0px; -webkit-box-reflect: 0px  linear-gradient(0deg, rgba(0,0,0,)); overflow: hidden; border-color: black; border-width: 0px; border-style: solid; background-color: rgb(236, 245, 253);  }
                            #imgPainel{position: absolute; left: 0.0px; top: 0.0px; width: 110.0px; height: 71.0px; box-sizing: content-box; margin: 0px; padding: 0px; border-color: black; border-width: 0px; border-style: solid; background-color: rgb(255, 255, 0);  }
                #data{position: absolute; left: 15.0px; top: 4.0px; width: 159.0px; height: 29.0px; box-sizing: content-box; margin: 0px; padding: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; -webkit-box-reflect: 0px  linear-gradient(0deg, rgba(0,0,0,)); scroll-padding: 0px; scroll-padding-block: 0px; scroll-padding-inline: 0px; border-color: black; border-width: 0px; border-style: solid; font-family: 'Arial', sans-serif; font-weight: bolder; font-size: 25.0px;  }
                #seqCapas{position: absolute; left: 15px; top: 475.0px; width: 91.0px; height: 52.0px; box-sizing: content-box; margin: 0px; padding: 0px; overflow: hidden; border-color: rgb(35, 72, 220); border-width: 0.0px; border-style: solid; background-color: rgb(215, 235, 211);  }
                    #capaPequena{position: absolute; left: 0.0px; top: 0.0px; width: 100.0px; height: 50px; box-sizing: content-box; margin: 0px; padding: 0px; -webkit-box-reflect: 0px  linear-gradient(0deg, rgba(0,0,0,)); border-color: black; border-width: 0px; border-style: solid; background-color: rgb(255, 255, 0);  }
                #nomePrim{position: absolute; left: 302.0px; top: 4px; width: 251.0px; height: 33.0px; box-sizing: content-box; margin: 0px; padding: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; -webkit-box-reflect: 0px  linear-gradient(0deg, rgba(0,0,0,)); scroll-padding: 0px; scroll-padding-block: 0px; scroll-padding-inline: 0px; border-color: black; border-width: 0px; border-style: solid; color: rgb(128, 0, 255); font-family: 'Arial', sans-serif; font-style: italic; font-weight: bold; font-size: 16.0px;  }
                #PrimPag{position: absolute; left: 302px; top: 42.0px; width: 250.0px; height: 347.0px; box-sizing: content-box; margin: 0px; padding: 0px; overflow: hidden; border-color: black; border-width: 0px; border-style: solid; background-color: rgb(255, 255, 0);  }
                    #img-424-Map{position: absolute; left: 0.0px; top: 0.0px; width: 250.0px; height: 349.0px; box-sizing: content-box; margin: 0px; padding: 0px; border-color: black; border-width: 0px; border-style: solid; background-color: rgb(255, 255, 0);  }
                    #img-424{position: absolute; left: 0.0px; top: 0.0px; width: 250.0px; height: 349.0px; box-sizing: content-box; margin: 0px; padding: 0px; border-color: black; border-width: 0px; border-style: solid; background-color: rgb(255, 128, 0);  }
                #input-686{position: absolute; left: 179.0px; top: 10.0px; width: 48.0px; height: 22.0px; box-sizing: content-box; margin: 0px; padding: 0px; padding-left: 10.0px; -webkit-box-reflect: 0px  linear-gradient(0deg, rgba(0,0,0,)); border-color: black; border-radius: 2.0px; border-width: 1.0px; border-style: solid; background-color: rgb(215, 235, 211); color: rgb(0, 0, 255); font-family: 'Arial', sans-serif; font-weight: bold; font-size: 20.0px;  }
                #Capa{position: absolute; left: 15.0px; top: 38.0px; width: 206.0px; height: 424.0px; box-sizing: content-box; margin: 0px; padding: 0px; overflow: hidden; border-color: rgb(64, 0, 128); border-width: 1.0px; border-style: solid; background-color: rgb(215, 235, 211);  }
                    #img-418{position: absolute; left: 0.0px; top: 0.0px; width: 206.0px; height: 424.0px; box-sizing: content-box; margin: 0px; padding: 0px; border-color: black; border-width: 0px; border-style: solid; background-color: rgb(215, 235, 211);  }
                    /* [FORMAT OBJS] */
            
            /*  ----------- [FORMATAÇÃO REMOTA]  ---------------------------------  */

        </style>

    </head>

    
    <!--  -------------- Define Elementos  -------------  -->
    <body id="Corpo" nomeProj="Tio"  deslX="0" deslY="0">
        <div id="Fundo" iw=416 >
            <input id="checkIncl" iw=434  type="checkbox" readonly onclick="return false" checked>
            <div id="alteCapa" iw=432  nLar=0 nCar=0 hPar=0 vPar=0 scroll="hidden">
                <img id="peqAlte" iw=433  src="Tio/Imagens/CSS/Motim.JPG">
            </div> <!-- [alteCapa]   -->

            <div id="divBranca" iw=427  scroll="scroll">
                <div id="divGeral" iw=428  nLar=5 nCar=4 hPar=45 vPar=10 scroll="hidden"  ascScr="divBranca">
                    <div id="divPaiNum" iw=430   ascScr="divBranca">
                        <p id="divPaiNum-Txt" style="position: absolute; left: 10px; top: -15px; width:81px ">n. 20</p>
                    </div> <!-- [divPaiNum]   -->

                    <div id="divPaiCapa" iw=429  scroll="hidden"  ascScr="divBranca">
                        <img id="imgPainel" iw=431   ascScr="divBranca" src="Tio/Imagens/CSS/1940 - Cine São Sebastião.jpeg">
                    </div> <!-- [divPaiCapa]   -->

                </div> <!-- [divGeral]   -->

            </div> <!-- [divBranca]   -->

            <div id="data" iw=426 >
                <p id="data-Txt" style="position: absolute; left: 0px; top: -25px; width:159px ">janeiro</p>
            </div> <!-- [data]   -->

            <div id="seqCapas" iw=424  nLar=1 nCar=3 hPar=5 vPar=10 scroll="hidden">
                <img id="capaPequena" iw=425  nLar=0 nCar=0 hPar=0 vPar=0 zoomMenuDiv="" curLado="" zoomFat="" src="Tio/Imagens/CSS/br_tp_0024a_001.jpeg">
            </div> <!-- [seqCapas]   -->

            <div id="nomePrim" iw=423 >
                <p id="nomePrim-Txt" style="position: absolute; left: 10px; top: -16px; width:241px ">NomePrim</p>
            </div> <!-- [nomePrim]   -->

            <div id="PrimPag" iw=420  scroll="hidden">
                <map id="img-424-Map" iw=422  name="img-424-Map"></map>
                <img id="img-424" iw=421  zoomMenuDiv="lupa" curLado="120" zoomFat="3.0" src="Tio/Imagens/CSS/Z - O Holandês Voador_E1_62.jpeg">
            </div> <!-- [PrimPag]   -->

            <input id="input-686" iw=419 >
            <div id="Capa" iw=417  scroll="hidden">
                <img id="img-418" iw=418  zoomMenuDiv="self" curLado="100" zoomFat="3" src="Tio/Imagens/CSS/br_tp_0026a_001.jpeg">
            </div> <!-- [Capa]   -->
        </div> <!-- [Fundo]   -->

    <!--  --------------[Define Elementos] -------------  -->

    
    <!--  ............  Rotinas Gerais , Variáveis e Trap de Eventos - JS  ...........  -->
    <script type="text/javascript" src="evento.js">      </script>
    <!--  carrega arquivo -Var.js  -->
    <script type="text/javascript" src="Tio/ArquvosJs/Tio-Var.js">   </script>
    <!-- [carrega arquivo -Var.js]  -->

    
    
    <!--  ............ Trap de Eventos - JS ...........  -->
    <script>
        /*      VARIÁVEIS DE EVENTOS E ELEMENTOS
        
                <body id="Corpo" deslX="120" deslY="320">

                evento ;  Leventos  = []

                eleTar ;  eleTaId  ;  eleTaTy      ;  taStyle  
                eleOn  ;  eleOnId  ;  eleOnTy      ;  onStyle   
                eleFoc ;  eleFoId  ;  eleFoTy      ;  foStyle   

                xMe    ;  yMe   // relativas ao elemento
                xMw    ;  yMw   // relativas à  window
                xMs    ;  yMs   // relativas à  screen

        */

        var corrTam = 2
        // . toggles
        var togg    = -1 , togMar = -1 , p = 0 , iCar = 1 , dirS = '', celElA = ''
        var arqPainel = ''   ,   arqParale = '' , numAlte = 20, corN = 0

        // ------- Trap de Planilha
        
        // . . . SelectionChange
        function SelectionChange() {
            // . . . SelectionChange   -    
            //      Cells:  iElSel, jElSel      iElSelA, jElSelA        valList = ListPlan[divSheetId][iElN][jElN]
            //      Sheet:  iSheet, jSheet      iSheetA, jSheetA        elId    = divSheetId+'-Pla:('+iSheetA+','+jSheetA+')'
            //                                                          elId: prox, elAntR          
            //      valores:    iniValueInput
            //                  finValueInputA, iniValueInputA - antes de atualização
            //
            //      i=2 ; j=3 ; elId    = divSheetId+'-Pla:('+i+','+j+')'

            // ...............
           // . . . input de Plan
           inpAntClass = inpAnt.className  ;   if(inpAntClass==undefined){ inpAntClass='' }
           inpCurClass = inpCur.className  ;   if(inpCurClass==undefined){ inpCurClass='' }
           divSheetSc = ''
           iElSel=0; jElSel=0; iElSelA=0; jElSelA=0
     
           if (inpCurClass.includes("-Pla") ) {
                divSheetSc  = inpCur.getAttribute('divSheetId')
                iSheetSel   = Number(inpCur.getAttribute('iSheet'))  ; jSheetSel = Number(inpCur.getAttribute('jSheet'))
                iElSel      = Number(inpCur.getAttribute('iElN'))    ; jElSel    = Number(inpCur.getAttribute('jElN'))
            }
            if (inpAntClass.includes("-Pla")) { 
                divSheetSc  = inpAnt.getAttribute('divSheetId')
                iSheetSelA  = Number(inpAnt.getAttribute('iSheet'))  ; jSheetSelA = Number(inpAnt.getAttribute('jSheet'))
                iElSelA     = Number(inpAnt.getAttribute('iElN'))    ; jElSelA    = Number(inpAnt.getAttribute('jElN'))
            }
            // ............... [SYST]

            // .... Lost Focus
            if(entraInp=='Lost'){
                // ..
                if(jElSelA==4){ finValueInputA = iElSelA-2}
                // ...
                
                // -------- atualiza ListPlan - SYST
                try{ ListPlan[divSheetId][iElSelA][jElSelA] = finValueInputA ; inpAnt.value = finValueInputA } catch{}
            }
            // ....[Lost Focus]

            // .... Got Focus
            if(entraInp=='Got'){
                // ..
                if(jElSel==8){ iniValueInput = iElSel-2}
                // ...
                
                // -------- atualiza ListPlan - SYST
                try{ ListPlan[divSheetId][iElSel][jElSel]   = iniValueInput ; inpCur.value = iniValueInput  } catch{}
            }
            // ....[Got Focus]


            // ........
            return
        }         
        // . . .[SelectionChange]


        // . . . valor em printCell
        function planValorTrap(divSheetId, iC, jC) {
            lFrz     = Cells[divSheetId][0][0]['lFrz'] ; cFrz      = Cells[divSheetId][0][0]['cFrz']
            lin = iC-lFrz+1 ; col = jC-cFrz+1 // coords de ListPlan
            // . . . 


            // ........
            return valor
        }
        // . . .[valor em printCell]

        // -------[Trap de Planilha]

        // ------- Trap de Array
        function ContentCellArr(divArrId, iC, jC, kCell) {
            // . . . 
            if(divArrId=='divGeral'){
                nLinPai0 = ListPlan[arqPainel][0][0]  
                dirS     = ListPlan[arqPainel][0][1]
                num  = kCell
                if(num<=nLinPai0){
                    capaS  = dirS + ListPlan[arqPainel][num][1]
                    capaId = el('imgPainel',iC,jC).id
                    fomatImg(imgId=capaId, imgSrc=capaS, x='0', y='0', w='0', h='0', fitS='fitH', faEscX = 1, faEscY = 1, adjDiv='')
                    el('divPaiNum-Txt',iC,jC).innerHTML = 'N. '+(num+corN)+' '+ListPlan[arqPainel][num][4]
                }
            }
            // ........
            return
        }
        // -------[Trap de Array]

        // ------- Trap de Load Arquivo
        function trapLoad(divLoadId){
            // .......

            // ---- cria Painel sobre Array
            if(LoadedJS[arqPainel]==1 && LoadedJS[arqParale]==1){

                // . . . preenche atributos de Painel
                nLinPai0 = ListPlan[arqPainel][0][0]
                dirS     = ListPlan[arqPainel][0][1]
                
                num = 2
                mostraNr(num)
                // ... preenche painel                
                preenchePainel(cellCurr=num, painelNome='divGeral', centra=1, nCelPaiF=nLinPai0, porLInha=1)
                // ...[preenche painel]
            }
            // .......
        }
        // -------[Trap de Load Arquivo]


        // ---- Início Local
        function iniLoc(){
            // ..........

            // -------- inicia com console
            leftCon = 10 ;  hab=0 ; proprHab = 0
            // --------[inicia com console]

            loadDadosJS("div-417", arqDados='CapasTP.js')
            loadDadosJS("div-418", arqDados='CapasMK.js')

            arqPainel = 'div-417'
            arqParale = 'div-418'            
        }
        // ----[Início Local]

        //  --------------------------------------------

        //  -------------- Trap de Eventos -------------
        function trapEvent() {

            //try{ el('divPaiNum-Txt_16:1').addEventListener("DOMAttrModified", change) ;  function change() { print(' ************** CHANGE') } } catch{}
            //try{ print(' ************** CHANGE'+el('divPaiNum-Txt_16:1').innerHTML)  } catch{}

            // ... segunda rodada
            if (corrTam==1){
                corrTam = 3
                // ..
                
                // ..
                
            }
            // ...[segunda rodada]

            // ... primeira rodada
            if (corrTam==2){
                corrTam = 0
                // ..
                
                corrTam = 1
                // ..
            }
            // ...[primeira rodada]

            // ******** GERAL DE EVENTOS

            // .... entra número em input
            if(evento=='keydown' && eleOnId=='input-686' && keyCode==13) {
                num     = parseInt(el('input-686').value)
                mostraNr(num-corN)
                // ... preenche painel
                preenchePainel(cellCurr=num-corN, painelNome='divGeral', centra=1, nCelPaiF=nLinPai0, porLInha=1)
            }
            
            // . . . click em capas rodapé
            if(evento=='click' && eleTaClass=='seqCapas') {
                num     = parseInt(el('input-686').value) + (eleTa.getAttribute('jarray')-2)
                mostraNr(num-corN)
            }
            
            // . . .click em painel
            if(evento=='click' && eleTaClass=='divGeral') {                
                num     = parseInt(eleTa.getAttribute('kcelarray'))    
                iAr     = parseInt(eleTa.getAttribute('iArray'))    ; jAr     = parseInt(eleTa.getAttribute('jArray'))
                mostraNr(num)
            }

            // . . .enter em painel
            if(evento=='keydown' && (keyCode==13)) {                
                num     = Painel['divGeral']['cellCurr']
                mostraNr(num)
            }

            // .... toggle MK/TP
            if(evento=='click' && eleTaId=='peqAlte') {
                num = numAlte
                arqRes = arqPainel ; arqPainel = arqParale  ; arqParale = arqRes

                corN = 0
                if(arqPainel=='div-418')  { corN = 129 }

                mostraNr(num)
                // ... preenche painel        
                Painel['divGeral']['novoPainel'] = 1        
                preenchePainel(cellCurr=num, painelNome='divGeral', centra=1, nCelPaiF=nLinPai0, porLInha=1)
            }


            // . . . 

        // ********[GERAL DE EVENTOS]

        // ......
        } // . . . [trapEvent()]
        //  --------------[Trap de Eventos] -------------
        //  --------------------------------------------
        function mostraNr(num){
            // . . . mostraNr(num)
            nLinPai0 = ListPlan[arqPainel][0][0]
            dirS     = ListPlan[arqPainel][0][1]
            if (num<=nLinPai0 && num>0){
                inclu = ListPlan[arqPainel][num][4]
                tpNS    = String(num+corN).padStart(2, '0')
                el('input-686').value = tpNS
                if(inclu!=''){ el('checkIncl').checked = true  }
                if(inclu==''){ el('checkIncl').checked = false }
                capaS = dirS + ListPlan[arqPainel][num][1]
                primS = dirS + ListPlan[arqPainel][num][2]
                fomatImg(imgId='img-418', imgSrc=capaS,  x='0', y='0', w='0', h='0', fitS='fitH', faEscX = 1, faEscY = 1, adjDiv=1)
                fomatImg(imgId='img-424', imgSrc=primS,  x='0', y='0', w='0', h='0', fitS='fitH', faEscX = 1, faEscY = 1, adjDiv=1)

                el('nomePrim-Txt').innerHTML    = ListPlan[arqPainel][num][3]
                el('data-Txt').innerHTML        = ListPlan[arqPainel][num][5]

                // . . . rodapé
                for (iC=1 ; iC<=3 ; iC++){
                    nRoda = num+iC-2
                    if(nRoda>0 && nRoda<=nLinPai0){ 
                        capaS = dirS + ListPlan[arqPainel][num+iC-2][1]
                        capaId = el('capaPequena',1,iC).id
                        fomatImg(imgId=capaId, imgSrc=capaS, x='0', y='0', w='0', h='0', fitS='fitW', faEscX = 1, faEscY = 1, adjDiv=1)
                    }
                }
                
                // ..... calcula numAlte
                dataPinc = DataConv(dataS=ListPlan[arqPainel][num][5])['JDN']
                for (numAlte=1 ; numAlte<=ListPlan[arqParale][0][0] ; numAlte++){
                    dataAlte = DataConv( ListPlan[arqParale][numAlte][5] )['JDN']
                    if( (dataAlte-dataPinc)>=0 ) { break }
                }
                capaS = ListPlan[arqParale][0][1] + ListPlan[arqParale][numAlte][1]
                fomatImg(imgId='peqAlte', imgSrc=capaS,  x='0', y='0', w='0', h='0', fitS='fitH', faEscX = 1, faEscY = 1, adjDiv=1)
            }
            // . . .[mostra número]
        }

    </script>
    <!--  ............ [Trap de Eventos - JS] ...........  -->


    <!--  ...  -->
    </body>
    <!--  ... [body] ...  -->        
</html>
